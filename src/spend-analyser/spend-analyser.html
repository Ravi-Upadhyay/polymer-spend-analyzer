<link rel="import" href="../../bower_components/polymer/polymer-element.html">

<link rel="import" href="../../bower_components/app-route/app-location.html">
<link rel="import" href="../../bower_components/app-route/app-route.html">
<link rel="import" href="../../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../../bower_components/app-route/app-route.html">


<link rel="import" href="../components/make-payment.html">
<link rel="import" href="../components/payment-status.html">
<link rel="import" href="../components/payment-history.html">
<link rel="import" href="../components/payment-analyser.html">
<link rel="import" href="../components/common-header.html">

<dom-module id="spend-analyser">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>
      <!-- <app-location
        route="{{route}}"
        url-space-regex="^[[rootPath]]">
      </app-location> -->
      <app-location
        route="{{route}}">
      </app-location>
  
      <!-- <app-route
          route="{{route}}"
          pattern="[[rootPath]]:page"
          data="{{routeData}}"
          tail="{{subroute}}">
      </app-route> -->
      <app-route
          route="{{route}}"
          pattern="/:page"
          data="{{routeData}}"
          tail="{{subroute}}">
      </app-route>

    <!-- <h2>Hello [[prop1]]!</h2> -->
    <common-header></common-header>
    <iron-pages
        selected="[[page]]"
        attr-for-selected="name"
        role="main">
      <make-payment name="payments"></make-payment>
      <payment-history name="transactions"></payment-history>
      <payment-analyser name="analyser"></payment-analyser>
      <!-- <my-view404 name="view404"></my-view404> -->
    </iron-pages>

    <!-- <make-payment></make-payment> -->
    <!--<payment-status></payment-status>-->
    <!--<payment-history></payment-history>-->
    <!--<payment-analyser></payment-analyser>-->

  </template>

  <script>
    /**
     * @customElement
     * @polymer
     */
    class SpendAnalyser extends Polymer.Element {
      constructor() {
        super();
        // console.log(route);
        var that = this;
        window.setInterval(function(){
          console.log(that.route);
          console.log(that.rootPath);
          console.log(that.routeData);
          console.log(that.subroute);
          console.log(that.page);
        }, 5000);
      }
      
      static get is() { return 'spend-analyser'; }

      static get properties() {
        return {
          prop1: {
            type: String,
            value: 'spend-analyser'
          },
          page: {
            type: String,
            reflectToAttribute: true
            // observer: '_pageChanged',
          },
          routeData: Object,
          subroute: Object,
          // This shouldn't be neccessary, but the Analyzer isn't picking up
          // Polymer.Element#rootPath
          rootPath: String,
          myRoutes : {
            type  : Object,
            value : {
              menuItems : {
                payments    : "make-payment.html",
                transactions: "payment-history.html",
                analyser    : "payment-analyser.html",
              },
              login    : "login-form.html",
              status   : "payment-status.html"
            }
          }
        }
      }

      static get observers() {
        return [
          '_routePageChanged(routeData.page)',
        ];
      }

      _routePageChanged(page) {
        // If no page was found in the route data, page will be an empty string.
        // Default to 'view1' in that case.
        this.page = page || 'payments';

        // Close a non-persistent drawer when the page & route are changed.
        // if (!this.$.drawer.persistent) {
        //   this.$.drawer.close();
        // }
      }
    }
  

    window.customElements.define(SpendAnalyser.is, SpendAnalyser);
  </script>
</dom-module>
